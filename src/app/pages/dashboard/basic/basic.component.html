<emr-tab-panel [activeItemId]="activeTabId" compact class="h-[600px] border-t border-t-default border-b border-b-default border-s border-s-default">
  <!-- Header remains unchanged -->
  <emr-tab-panel-header>
    <emr-tab-panel-nav>
      @for (tab of tabs; track tab.id) {
        <emr-tab-panel-item [for]="tab.id" [matTooltip]="tab.tooltip" matTooltipPosition="after">
          <emr-icon [name]="tab.icon" emrTabPanelItemIcon></emr-icon>
        </emr-tab-panel-item>
      }
    </emr-tab-panel-nav>
  </emr-tab-panel-header>

  <emr-tab-panel-aside>
    @for (tab of tabs; track tab.id) {
      <ng-template [emrTabPanelAsideContent]="tab.id">
        @if (tab.nested) {
          <!-- Nested tab panel -->
          <emr-tab-panel [activeItemId]="tab.nestedActiveId" compact class="h-full">
            <emr-tab-panel-header>
              <emr-tab-panel-nav>
                @for (nestedTab of tab.nestedTabs; track nestedTab.id) {
                  <emr-tab-panel-item [for]="nestedTab.id" [matTooltip]="nestedTab.tooltip" matTooltipPosition="after">
                    <emr-icon [name]="nestedTab.icon" emrTabPanelItemIcon></emr-icon>
                  </emr-tab-panel-item>
                }
              </emr-tab-panel-nav>
            </emr-tab-panel-header>
            
            <emr-tab-panel-aside>
              @for (nestedTab of tab.nestedTabs; track nestedTab.id) {
                <ng-template [emrTabPanelAsideContent]="nestedTab.id">
                  @if (nestedTab.pdfSrc) {
                    <pdf-viewer [src]="nestedTab.pdfSrc"
                      [render-text]="true"
                      [original-size]="false"
                      style="width: 1100px; height: 700px">
                    </pdf-viewer>
                  } @else if (nestedTab.videoSrc) {
                    <div class="video-container" style="width: 1100px; height: 700px">
                      @if (isYoutubeLink(nestedTab.videoSrc)) {
                        <iframe width="100%" height="100%" 
                          [src]="getSafeYoutubeUrl(nestedTab.videoSrc)" 
                          frameborder="0" 
                          allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                          allowfullscreen>
                        </iframe>
                      } @else {
                        <video controls style="width: 100%; height: 100%">
                          <source [src]="nestedTab.videoSrc" type="video/mp4">
                          Your browser does not support the video tag.
                        </video>
                      }
                    </div>
                  } @else {
                    <div class="empty-content">No content available</div>
                  }
                </ng-template>
              }
            </emr-tab-panel-aside>
          </emr-tab-panel>
        }
        
        @else if (tab.pdfSrc) {
          <pdf-viewer [src]="tab.pdfSrc"
            [render-text]="true"
            [original-size]="false"
            style="width: 1100px; height: 700px">
          </pdf-viewer>
        }
        
        @else if (tab.videoSrc) {
          <div class="video-container" style="width: 1100px; height: 700px">
            @if (isYoutubeLink(tab.videoSrc)) {
              <iframe width="100%" height="100%" 
                [src]="getSafeYoutubeUrl(tab.videoSrc)" 
                frameborder="0" 
                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                allowfullscreen>
              </iframe>
            } @else {
              <video controls style="width: 100%; height: 100%">
                <source [src]="tab.videoSrc" type="video/mp4">
                Your browser does not support the video tag.
              </video>
            }
          </div>
        }
        
        @else {
          <div class="empty-content">No content available</div>
        }
      </ng-template>
    }
  </emr-tab-panel-aside>
</emr-tab-panel>